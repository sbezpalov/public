# Clear-1CServerCache

PowerShell-скрипт промышленного уровня для **безопасной очистки серверного кэша 1С:Предприятие** в окно обслуживания.

Основной принцип скрипта:

> **Если службы 1С не зарегистрированы в реестре Windows — очищать нечего.**

Реестр является единственным источником истины.

---

## Основные возможности

- Определение серверных служб 1С через реестр (`ragent.exe`)
- Автоматическое извлечение `SrvInfoPath` из параметров запуска (`-d`)
- Безопасный сценарий обслуживания:
  - Остановка служб
  - Очистка кэша
  - Запуск служб
- Корректный порядок управления службами:
  - Остановка: **Server → Agent**
  - Запуск: **Agent → Server**
- Поддержка `-WhatIf` / `-Confirm`
- Поддержка локализации (EN / RU)
- Предназначен для выполнения в окно обслуживания

---

## Требования

- Windows Server / Windows с установленным сервером 1С
- PowerShell 5.1+
- Права администратора

---

## Использование

```powershell
.\Clear-1CServerCache.ps1
```

Пробный запуск:

```powershell
.\Clear-1CServerCache.ps1 -WhatIf
```

---

## Версия

Текущая версия: **3.1.7**
